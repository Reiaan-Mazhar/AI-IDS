<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-IDS | Virtual Security Agent</title>
    <meta name="description"
        content="Next-Generation AI Intrusion Detection Framework with SHAP Explainability and LLM-based Security Advisor">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/static/styles.css">
</head>

<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon-wrapper">
                        <span class="logo-icon">üõ°Ô∏è</span>
                    </div>
                    <div class="logo-text">
                        <h1>AI-IDS</h1>
                        <span class="logo-subtitle">VIRTUAL SECURITY AGENT</span>
                    </div>
                </div>
            </div>

            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" data-page="dashboard" id="nav-dashboard">
                    <span class="nav-icon">üìä</span>
                    <span class="nav-label">Dashboard</span>
                </a>
                <a href="#" class="nav-item" data-page="inference" id="nav-inference">
                    <span class="nav-icon">üîç</span>
                    <span class="nav-label">Model Inference</span>
                </a>
                <a href="#" class="nav-item" data-page="realtime" id="nav-realtime">
                    <span class="nav-icon">üì°</span>
                    <span class="nav-label">Real-Time Detection</span>
                </a>
                <a href="#" class="nav-item" data-page="xai" id="nav-xai">
                    <span class="nav-icon">üß†</span>
                    <span class="nav-label">AI Explainability</span>
                </a>
                <a href="#" class="nav-item" data-page="threats" id="nav-threats">
                    <span class="nav-icon">‚ö†Ô∏è</span>
                    <span class="nav-label">Threat Reports</span>
                </a>
                <a href="#" class="nav-item" data-page="security" id="nav-security">
                    <span class="nav-icon">üõ°Ô∏è</span>
                    <span class="nav-label">Security Response</span>
                </a>
                <a href="#" class="nav-item" data-page="settings" id="nav-settings">
                    <span class="nav-icon">‚öôÔ∏è</span>
                    <span class="nav-label">Settings</span>
                </a>
                <a href="/logout" class="nav-item">
                    <span class="nav-icon">üö™</span>
                    <span class="nav-label">Logout</span>
                </a>
            </nav>

            <div class="sidebar-footer">
                <div class="system-status" id="system-status">
                    <span class="status-indicator"></span>
                    <span class="status-text">SYSTEM ONLINE</span>
                </div>
                <div class="sidebar-version">v2.0</div>
            </div>
        </aside>

        <!-- Mobile Sidebar Toggle -->
        <button class="sidebar-toggle" id="sidebar-toggle">
            <span></span><span></span><span></span>
        </button>

        <!-- Main Content -->
        <main class="main-content" id="main-content">

            <!-- ============================================
                 PAGE 1: DASHBOARD (Overview)
                 ============================================ -->
            <section class="page active" id="page-dashboard">
                <header class="page-header">
                    <div class="page-header-left">
                        <h2 class="page-title">Dashboard Overview</h2>
                        <p class="page-subtitle">System health and threat intelligence at a glance</p>
                    </div>
                    <div class="page-header-right">
                        <div class="header-time" id="header-time"></div>
                    </div>
                </header>

                <!-- Quick Stats -->
                <div class="stats-grid stats-grid-4">
                    <div class="stat-card stat-card--primary">
                        <div class="stat-card__icon">ü§ñ</div>
                        <div class="stat-card__content">
                            <span class="stat-card__value" id="dash-total-models">--</span>
                            <span class="stat-card__label">Models Available</span>
                        </div>
                    </div>
                    <div class="stat-card stat-card--danger">
                        <div class="stat-card__icon">üö®</div>
                        <div class="stat-card__content">
                            <span class="stat-card__value" id="dash-threats-today">0</span>
                            <span class="stat-card__label">Threats Detected</span>
                        </div>
                    </div>
                    <div class="stat-card stat-card--success">
                        <div class="stat-card__icon">‚úÖ</div>
                        <div class="stat-card__content">
                            <span class="stat-card__value" id="dash-flows-analyzed">0</span>
                            <span class="stat-card__label">Flows Analyzed</span>
                        </div>
                    </div>
                    <div class="stat-card stat-card--info">
                        <div class="stat-card__icon">‚è±Ô∏è</div>
                        <div class="stat-card__content">
                            <span class="stat-card__value" id="dash-uptime">Active</span>
                            <span class="stat-card__label">System Status</span>
                        </div>
                    </div>
                </div>

                <!-- Dashboard Body -->
                <div class="dashboard-body">
                    <!-- Quick Actions -->
                    <div class="glass-card quick-actions-card">
                        <h3 class="card-title">
                            <span class="card-title__icon">‚ö°</span>
                            Quick Actions
                        </h3>
                        <div class="quick-actions-grid">
                            <button class="quick-action-btn" data-action="goto-inference">
                                <span class="qa-icon">üîç</span>
                                <span class="qa-label">Run Inference</span>
                                <span class="qa-desc">Analyze a dataset with ML models</span>
                            </button>
                            <button class="quick-action-btn" data-action="goto-realtime">
                                <span class="qa-icon">üì°</span>
                                <span class="qa-label">Start Live Detection</span>
                                <span class="qa-desc">Monitor network traffic in real-time</span>
                            </button>
                            <button class="quick-action-btn" data-action="goto-threats">
                                <span class="qa-icon">‚ö†Ô∏è</span>
                                <span class="qa-label">View Threat Reports</span>
                                <span class="qa-desc">Review detected threat history</span>
                            </button>
                            <button class="quick-action-btn" data-action="goto-security">
                                <span class="qa-icon">üõ°Ô∏è</span>
                                <span class="qa-label">Security Response</span>
                                <span class="qa-desc">Generate firewall rules & alerts</span>
                            </button>
                        </div>
                    </div>

                    <!-- Dashboard Two-Column Layout -->
                    <div class="dashboard-two-col">
                        <!-- Threat Distribution -->
                        <div class="glass-card">
                            <h3 class="card-title">
                                <span class="card-title__icon">üìä</span>
                                Threat Distribution
                            </h3>
                            <div class="chart-area" id="dash-chart-area">
                                <canvas id="dash-threat-chart"></canvas>
                                <div class="chart-empty" id="dash-chart-empty">
                                    <span class="chart-empty__icon">üìà</span>
                                    <p>No threat data yet</p>
                                    <p class="text-muted">Run an analysis or start live detection</p>
                                </div>
                            </div>
                        </div>

                        <!-- Recent Activity -->
                        <div class="glass-card">
                            <h3 class="card-title">
                                <span class="card-title__icon">üïê</span>
                                Recent Activity
                            </h3>
                            <div class="activity-feed" id="dash-activity-feed">
                                <div class="activity-empty">
                                    <span class="activity-empty__icon">üì≠</span>
                                    <p>No recent activity</p>
                                    <p class="text-muted">Analysis results will appear here</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ============================================
                 PAGE 2: MODEL INFERENCE
                 ============================================ -->
            <section class="page" id="page-inference">
                <header class="page-header">
                    <div class="page-header-left">
                        <h2 class="page-title">Model Inference</h2>
                        <p class="page-subtitle">Run analysis with trained intrusion detection models</p>
                    </div>
                </header>

                <!-- Configuration Panel -->
                <div class="glass-card config-card">
                    <h3 class="card-title">
                        <span class="card-title__icon">‚öôÔ∏è</span>
                        Configuration
                    </h3>
                    <div class="config-grid">
                        <div class="form-group">
                            <label for="dataset-select">Dataset</label>
                            <select id="dataset-select" class="form-select">
                                <option value="">Select Dataset</option>
                                <option value="cicids2017">CICIDS2017</option>
                                <option value="nslkdd">NSL-KDD</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="model-select">Model</label>
                            <select id="model-select" class="form-select" disabled>
                                <option value="">Select Model</option>
                            </select>
                        </div>
                    </div>

                    <!-- Upload Area -->
                    <div class="upload-section">
                        <label class="form-label">Upload CSV Dataset</label>
                        <div class="upload-area" id="upload-area">
                            <input type="file" id="file-input" accept=".csv" hidden>
                            <div class="upload-content" id="upload-content">
                                <div class="upload-icon-wrapper">
                                    <span class="upload-icon-big">üì§</span>
                                </div>
                                <span class="upload-text">Drag & drop your CSV file here</span>
                                <span class="upload-subtext">or click to browse</span>
                            </div>
                            <div class="file-info" id="file-info" hidden>
                                <span class="file-icon">üìÑ</span>
                                <span class="file-name" id="file-name"></span>
                                <button class="remove-file-btn" id="remove-file">‚úï</button>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="action-bar">
                        <button class="btn btn-primary btn-lg" id="run-inference-btn" disabled>
                            <span class="btn-icon">‚ñ∂Ô∏è</span>
                            Run Analysis
                        </button>
                        <button class="btn btn-outline btn-lg" id="compare-models-btn" disabled>
                            <span class="btn-icon">üìä</span>
                            Compare All Models
                        </button>
                    </div>
                </div>

                <!-- Results Section (hidden until inference) -->
                <div id="inference-results-section" hidden>
                    <!-- Metrics Grid -->
                    <div class="stats-grid stats-grid-4" id="metrics-grid">
                        <div class="stat-card stat-card--success">
                            <div class="stat-card__icon">üéØ</div>
                            <div class="stat-card__content">
                                <span class="stat-card__value" id="metric-accuracy">--%</span>
                                <span class="stat-card__label">Accuracy</span>
                            </div>
                        </div>
                        <div class="stat-card stat-card--info">
                            <div class="stat-card__icon">üîé</div>
                            <div class="stat-card__content">
                                <span class="stat-card__value" id="metric-precision">--%</span>
                                <span class="stat-card__label">Precision</span>
                            </div>
                        </div>
                        <div class="stat-card stat-card--warning">
                            <div class="stat-card__icon">üì°</div>
                            <div class="stat-card__content">
                                <span class="stat-card__value" id="metric-recall">--%</span>
                                <span class="stat-card__label">Recall</span>
                            </div>
                        </div>
                        <div class="stat-card stat-card--primary">
                            <div class="stat-card__icon">‚öñÔ∏è</div>
                            <div class="stat-card__content">
                                <span class="stat-card__value" id="metric-f1">--%</span>
                                <span class="stat-card__label">F1 Score</span>
                            </div>
                        </div>
                    </div>

                    <!-- Stats Summary -->
                    <div class="stats-grid stats-grid-3">
                        <div class="stat-card stat-card--default">
                            <div class="stat-card__content">
                                <span class="stat-card__value" id="total-samples">0</span>
                                <span class="stat-card__label">Total Flows Analyzed</span>
                            </div>
                        </div>
                        <div class="stat-card stat-card--danger">
                            <div class="stat-card__content">
                                <span class="stat-card__value" id="threats-detected">0</span>
                                <span class="stat-card__label">Threats Detected</span>
                            </div>
                        </div>
                        <div class="stat-card stat-card--default">
                            <div class="stat-card__content">
                                <span class="stat-card__value stat-card__value--sm" id="model-name">--</span>
                                <span class="stat-card__label">Active Model</span>
                            </div>
                        </div>
                    </div>

                    <!-- Chart & Table -->
                    <div class="results-two-col">
                        <div class="glass-card">
                            <h3 class="card-title">
                                <span class="card-title__icon">üìä</span>
                                Prediction Distribution
                            </h3>
                            <div class="chart-area">
                                <canvas id="distribution-chart"></canvas>
                            </div>
                        </div>
                        <div class="glass-card">
                            <h3 class="card-title">
                                <span class="card-title__icon">üìã</span>
                                Detection Results
                                <span class="badge badge--muted" id="results-count-badge"></span>
                            </h3>
                            <div class="table-wrapper" id="results-table-wrapper">
                                <table class="data-table" id="predictions-table">
                                    <thead>
                                        <tr>
                                            <th>Sample #</th>
                                            <th>Prediction</th>
                                            <th>Confidence</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody id="predictions-body">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Comparison Panel (hidden until comparison) -->
                <div class="glass-card" id="comparison-panel" hidden>
                    <h3 class="card-title">
                        <span class="card-title__icon">üîç</span>
                        Model Comparison
                    </h3>
                    <div class="comparison-content" id="comparison-content">
                    </div>
                </div>
            </section>

            <!-- ============================================
                 PAGE 3: REAL-TIME DETECTION
                 ============================================ -->
            <section class="page" id="page-realtime">
                <header class="page-header">
                    <div class="page-header-left">
                        <h2 class="page-title">Real-Time Detection</h2>
                        <p class="page-subtitle">Monitor network traffic and detect threats in real-time</p>
                    </div>
                    <div class="page-header-right">
                        <span class="live-badge" id="live-badge" hidden>
                            <span class="live-dot"></span> LIVE
                        </span>
                    </div>
                </header>

                <!-- Control Panels -->
                <div class="realtime-controls-grid">
                    <!-- Capture Configuration -->
                    <div class="glass-card">
                        <h3 class="card-title">
                            <span class="card-title__icon">üì°</span>
                            Capture Settings
                        </h3>
                        <div class="form-group">
                            <label>Network Interface</label>
                            <select id="capture-interface" class="form-select">
                                <option value="lo">lo (Loopback)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Detection Model</label>
                            <select id="realtime-model" class="form-select">
                                <option value="rf_model_1">Random Forest</option>
                                <option value="dt_model_1">Decision Tree</option>
                                <option value="xgboost">XGBoost</option>
                            </select>
                        </div>
                        <div class="btn-group">
                            <button class="btn btn-success btn-lg" id="start-capture-btn">
                                <span class="btn-icon">‚ñ∂Ô∏è</span>
                                Start Capture
                            </button>
                            <button class="btn btn-danger btn-lg" id="stop-capture-btn" hidden>
                                <span class="btn-icon">‚èπÔ∏è</span>
                                Stop Capture
                            </button>
                        </div>
                    </div>

                    <!-- Attack Simulation -->
                    <div class="glass-card">
                        <h3 class="card-title">
                            <span class="card-title__icon">‚öîÔ∏è</span>
                            Attack Simulation
                        </h3>
                        <div class="form-group">
                            <label>Attack Type</label>
                            <select id="attack-type" class="form-select">
                                <option value="port_scan">Port Scan</option>
                                <option value="syn_flood">SYN Flood</option>
                                <option value="http_flood">HTTP Flood</option>
                                <option value="ssh_brute">SSH Brute Force</option>
                                <option value="udp_flood">UDP Flood</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Intensity</label>
                            <select id="attack-intensity" class="form-select">
                                <option value="low">Low</option>
                                <option value="medium" selected>Medium</option>
                                <option value="high">High</option>
                            </select>
                        </div>
                        <div class="btn-group">
                            <button class="btn btn-danger btn-lg" id="start-attack-btn">
                                <span class="btn-icon">‚öîÔ∏è</span>
                                Launch Attack
                            </button>
                            <button class="btn btn-outline btn-lg" id="stop-attack-btn" hidden>
                                <span class="btn-icon">üõë</span>
                                Stop Attack
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Real-Time Stats -->
                <div class="stats-grid stats-grid-4" id="realtime-stats">
                    <div class="stat-card stat-card--primary">
                        <div class="stat-card__content">
                            <span class="stat-card__value" id="rt-packets">0</span>
                            <span class="stat-card__label">Packets Captured</span>
                        </div>
                    </div>
                    <div class="stat-card stat-card--danger">
                        <div class="stat-card__content">
                            <span class="stat-card__value" id="rt-threats">0</span>
                            <span class="stat-card__label">Threats Found</span>
                        </div>
                    </div>
                    <div class="stat-card stat-card--success">
                        <div class="stat-card__content">
                            <span class="stat-card__value" id="rt-benign">0</span>
                            <span class="stat-card__label">Benign Flows</span>
                        </div>
                    </div>
                    <div class="stat-card stat-card--info">
                        <div class="stat-card__content">
                            <span class="stat-card__value" id="rt-rate">0/s</span>
                            <span class="stat-card__label">Detection Rate</span>
                        </div>
                    </div>
                </div>

                <!-- Live Traffic Console -->
                <div class="glass-card console-card">
                    <h3 class="card-title">
                        <span class="card-title__icon">üíª</span>
                        Live Network Traffic Feed
                        <button class="btn btn-sm btn-ghost" id="clear-console-btn">Clear</button>
                    </h3>
                    <div class="traffic-console" id="traffic-console">
                        <div class="console-line info">
                            <span class="timestamp">[--:--:--]</span>
                            <span class="message">Waiting for capture to start...</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ============================================
                 PAGE 4: AI EXPLAINABILITY (XAI)
                 ============================================ -->
            <section class="page" id="page-xai">
                <header class="page-header">
                    <div class="page-header-left">
                        <h2 class="page-title">AI Explainability (XAI)</h2>
                        <p class="page-subtitle">Understand how the AI makes detection decisions using SHAP analysis</p>
                    </div>
                </header>

                <div class="xai-layout">
                    <!-- XAI Detection Reasoning -->
                    <div class="glass-card">
                        <h3 class="card-title">
                            <span class="card-title__icon">üî¨</span>
                            AI Detection Reasoning
                        </h3>
                        <div class="xai-content" id="xai-content">
                            <div class="xai-empty-state">
                                <span class="xai-empty__icon">üß†</span>
                                <h4>No Analysis Available</h4>
                                <p>Run an inference from the <strong>Model Inference</strong> page and click
                                    "Explain" on a prediction to see SHAP-based detection reasoning here.</p>
                            </div>
                            <div class="xai-result" id="xai-result" hidden>
                                <div class="xai-section">
                                    <div class="xai-label">
                                        <span class="xai-check">‚úì</span>
                                        AI Detection Reasoning
                                    </div>
                                    <p class="xai-text" id="xai-reasoning"></p>
                                </div>
                                <div class="feature-importance-section" id="feature-importance-mini">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Security Advisor -->
                    <div class="glass-card">
                        <h3 class="card-title">
                            <span class="card-title__icon">ü§ñ</span>
                            Security Advisor Agent
                        </h3>
                        <div class="advisor-content" id="advisor-content">
                            <div class="advisor-empty-state">
                                <span class="advisor-empty__icon">üí°</span>
                                <h4>Advisor Ready</h4>
                                <p>Detect threats to receive AI-powered security recommendations from the LLM advisor.
                                </p>
                            </div>
                            <div class="advisor-result" id="advisor-result" hidden>
                                <div class="advisor-section">
                                    <div class="advisor-label">
                                        <span class="advisor-check">‚úì</span>
                                        Strategic Defense Recommendations
                                    </div>
                                    <div class="advisor-text" id="advisor-text"></div>
                                </div>
                            </div>
                        </div>
                        <button class="btn btn-info btn-lg btn-block" id="get-advice-btn" disabled>
                            <span class="btn-icon">üí°</span>
                            Get Security Advice
                        </button>
                    </div>
                </div>

                <!-- SHAP Waterfall Plot Area -->
                <div class="glass-card" id="waterfall-plot-section" hidden>
                    <h3 class="card-title">
                        <span class="card-title__icon">üìä</span>
                        SHAP Waterfall Plot
                    </h3>
                    <div class="waterfall-plot-area">
                        <img id="waterfall-plot-img" class="waterfall-img" alt="SHAP Waterfall Plot" />
                    </div>
                </div>
            </section>

            <!-- ============================================
                 PAGE 5: THREAT REPORTS
                 ============================================ -->
            <section class="page" id="page-threats">
                <header class="page-header">
                    <div class="page-header-left">
                        <h2 class="page-title">Threat Reports</h2>
                        <p class="page-subtitle">Review and analyze detected threat history</p>
                    </div>
                    <div class="page-header-right">
                        <button class="btn btn-outline" id="refresh-logs-btn">
                            <span class="btn-icon">üîÑ</span>
                            Refresh
                        </button>
                        <button class="btn btn-danger" id="clear-logs-btn">
                            <span class="btn-icon">üóëÔ∏è</span>
                            Clear All
                        </button>
                    </div>
                </header>

                <!-- Threat Stats -->
                <div class="stats-grid stats-grid-3">
                    <div class="stat-card stat-card--danger">
                        <div class="stat-card__icon">üìã</div>
                        <div class="stat-card__content">
                            <span class="stat-card__value" id="logs-total-count">0</span>
                            <span class="stat-card__label">Total Reports</span>
                        </div>
                    </div>
                    <div class="stat-card stat-card--info">
                        <div class="stat-card__icon">üß†</div>
                        <div class="stat-card__content">
                            <span class="stat-card__value" id="logs-xai-count">0</span>
                            <span class="stat-card__label">With XAI Analysis</span>
                        </div>
                    </div>
                    <div class="stat-card stat-card--warning">
                        <div class="stat-card__icon">üî•</div>
                        <div class="stat-card__content">
                            <span class="stat-card__value" id="logs-critical-count">0</span>
                            <span class="stat-card__label">High Confidence</span>
                        </div>
                    </div>
                </div>

                <!-- Threats Table -->
                <div class="glass-card">
                    <h3 class="card-title">
                        <span class="card-title__icon">üìã</span>
                        Threat Log History
                    </h3>
                    <div class="table-wrapper">
                        <table class="data-table" id="threat-logs-table">
                            <thead>
                                <tr>
                                    <th>Timestamp</th>
                                    <th>Attack Type</th>
                                    <th>Source IP</th>
                                    <th>Destination</th>
                                    <th>Confidence</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="threat-logs-body">
                            </tbody>
                        </table>
                    </div>
                    <div class="empty-state" id="threat-logs-empty" hidden>
                        <span class="empty-state__icon">üì≠</span>
                        <h4>No Threat Reports Found</h4>
                        <p>Start the demo mode on the Real-Time Detection page to generate some threats!</p>
                    </div>
                </div>
            </section>

            <!-- ============================================
                 PAGE 6: SECURITY RESPONSE
                 ============================================ -->
            <section class="page" id="page-security">
                <header class="page-header">
                    <div class="page-header-left">
                        <h2 class="page-title">Security Response Center</h2>
                        <p class="page-subtitle">Generate defensive rules and manage threat notifications</p>
                    </div>
                    <div class="page-header-right">
                        <button class="btn btn-outline" id="test-webhook-btn">
                            <span class="btn-icon">üì°</span>
                            Test Webhook
                        </button>
                    </div>
                </header>

                <div class="security-grid">
                    <!-- Firewall Rules Generator -->
                    <div class="glass-card">
                        <h3 class="card-title">
                            <span class="card-title__icon">üî•</span>
                            Firewall Rules Generator
                        </h3>
                        <div class="firewall-form">
                            <div class="form-group">
                                <label>Source IP Address</label>
                                <input type="text" id="firewall-source-ip" class="form-input"
                                    placeholder="e.g., 192.168.1.100">
                            </div>
                            <div class="form-group">
                                <label>Attack Type</label>
                                <select id="firewall-attack-type" class="form-select">
                                    <option value="DDoS">DDoS</option>
                                    <option value="DoS">DoS</option>
                                    <option value="Port Scan">Port Scan</option>
                                    <option value="Brute Force">Brute Force</option>
                                    <option value="Bot">Bot</option>
                                    <option value="Web Attack">Web Attack</option>
                                </select>
                            </div>
                            <button class="btn btn-primary btn-lg btn-block" id="generate-rules-btn">
                                <span class="btn-icon">‚ö°</span>
                                Generate Rules
                            </button>
                        </div>

                        <div class="firewall-output" id="firewall-rules-output" hidden>
                            <div class="firewall-output__header">
                                <h4>Generated iptables Commands</h4>
                                <button class="btn btn-sm btn-ghost" id="copy-rules-btn">üìã Copy All</button>
                            </div>
                            <pre class="code-block" id="firewall-rules-code"></pre>
                            <div class="firewall-instructions" id="firewall-instructions"></div>
                        </div>
                    </div>

                    <!-- Webhook Notifications -->
                    <div class="glass-card">
                        <h3 class="card-title">
                            <span class="card-title__icon">üì°</span>
                            Webhook Notifications
                        </h3>
                        <div class="webhook-status" id="webhook-status">
                            <span class="status-dot"></span>
                            <span class="status-text">Checking configuration...</span>
                        </div>
                        <div class="notification-history">
                            <h4 class="sub-title">Recent Notifications</h4>
                            <div class="notification-list" id="notification-list">
                                <div class="empty-notifications">
                                    No notifications sent yet
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Actions Log -->
                <div class="glass-card">
                    <h3 class="card-title">
                        <span class="card-title__icon">üìã</span>
                        Suggested Actions Log
                    </h3>
                    <div class="table-wrapper">
                        <table class="data-table" id="rules-log-table">
                            <thead>
                                <tr>
                                    <th>Time</th>
                                    <th>Threat</th>
                                    <th>Source IP</th>
                                    <th>Rule</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="rules-log-body">
                            </tbody>
                        </table>
                    </div>
                    <div class="empty-state" id="rules-log-empty">
                        <p>No firewall rules generated yet. Detect threats to generate response actions.</p>
                    </div>
                </div>
            </section>

            <!-- ============================================
                 PAGE 7: SETTINGS
                 ============================================ -->
            <section class="page" id="page-settings">
                <header class="page-header">
                    <div class="page-header-left">
                        <h2 class="page-title">Settings</h2>
                        <p class="page-subtitle">Configure system parameters and preferences</p>
                    </div>
                </header>

                <div class="settings-grid">
                    <!-- API Configuration -->
                    <div class="glass-card">
                        <h3 class="card-title">
                            <span class="card-title__icon">üîë</span>
                            API Configuration
                        </h3>
                        <div class="form-group">
                            <label>Groq API Key</label>
                            <div class="input-with-action">
                                <input type="password" id="settings-groq-key" class="form-input"
                                    placeholder="Enter your Groq API key" value="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                                <button class="btn btn-sm btn-ghost" id="toggle-groq-key">üëÅÔ∏è</button>
                            </div>
                            <span class="form-hint">Used for the Security Advisor LLM agent</span>
                        </div>
                        <div class="form-group">
                            <label>Backend URL</label>
                            <input type="text" id="settings-backend-url" class="form-input"
                                value="http://localhost:5000" disabled>
                            <span class="form-hint">Flask server address (auto-detected)</span>
                        </div>
                    </div>

                    <!-- Model Configuration -->
                    <div class="glass-card">
                        <h3 class="card-title">
                            <span class="card-title__icon">ü§ñ</span>
                            Model Configuration
                        </h3>
                        <div class="form-group">
                            <label>Default Dataset</label>
                            <select id="settings-default-dataset" class="form-select">
                                <option value="cicids2017">CICIDS2017</option>
                                <option value="nslkdd">NSL-KDD</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Default Real-Time Model</label>
                            <select id="settings-default-model" class="form-select">
                                <option value="rf_model_1">Random Forest</option>
                                <option value="dt_model_1">Decision Tree</option>
                                <option value="xgboost">XGBoost</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Max Predictions Display</label>
                            <input type="number" id="settings-max-predictions" class="form-input" value="100" min="10"
                                max="1000">
                            <span class="form-hint">Maximum rows shown in prediction tables</span>
                        </div>
                    </div>

                    <!-- Notification Preferences -->
                    <div class="glass-card">
                        <h3 class="card-title">
                            <span class="card-title__icon">üîî</span>
                            Notification Preferences
                        </h3>
                        <div class="form-group toggle-group">
                            <label>Desktop Notifications</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="settings-desktop-notif" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <div class="form-group toggle-group">
                            <label>Sound Alerts on Threats</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="settings-sound-alerts">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <div class="form-group toggle-group">
                            <label>Auto-explain Threats</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="settings-auto-explain" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>

                    <!-- About -->
                    <div class="glass-card">
                        <h3 class="card-title">
                            <span class="card-title__icon">‚ÑπÔ∏è</span>
                            About
                        </h3>
                        <div class="about-info">
                            <div class="about-row">
                                <span class="about-label">Application</span>
                                <span class="about-value">AI-IDS Virtual Security Agent</span>
                            </div>
                            <div class="about-row">
                                <span class="about-label">Version</span>
                                <span class="about-value">2.0.0</span>
                            </div>
                            <div class="about-row">
                                <span class="about-label">Framework</span>
                                <span class="about-value">Flask + Socket.IO</span>
                            </div>
                            <div class="about-row">
                                <span class="about-label">ML Models</span>
                                <span class="about-value">PyTorch, Scikit-learn, XGBoost</span>
                            </div>
                            <div class="about-row">
                                <span class="about-label">Datasets</span>
                                <span class="about-value">CICIDS2017, NSL-KDD</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loading-overlay" hidden>
        <div class="loader-wrapper">
            <div class="loader"></div>
            <div class="loader-ring"></div>
        </div>
        <p class="loading-text" id="loading-text">Analyzing network traffic...</p>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toast-container"></div>

    <!-- XAI Explanation Modal -->
    <div id="xai-modal" class="modal" hidden>
        <div class="modal-content glass-card">
            <div class="modal-header">
                <h3><span class="card-title__icon">üî¨</span> AI Explanation Analysis</h3>
                <button class="close-modal" id="close-xai-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="xai-section">
                    <h4>Detection Reasoning</h4>
                    <p id="modal-xai-reasoning">Loading analysis...</p>
                </div>
                <div class="feature-importance-list" id="modal-feature-list">
                </div>
                <div class="waterfall-plot-area">
                    <img id="modal-waterfall-plot" class="waterfall-img" hidden alt="SHAP Waterfall Plot" />
                </div>
                <div class="xai-section" id="modal-security-advice" hidden>
                    <h4><span class="card-title__icon">üõ°Ô∏è</span> Security Recommendations</h4>
                    <div id="modal-advice-content" class="advisor-text"></div>
                    <pre id="modal-firewall-rules" class="code-block" hidden></pre>
                    <div class="action-bar" style="margin-top:20px;">
                        <button class="btn btn-danger btn-block" id="modal-execute-block-btn" hidden>
                            <span class="btn-icon">‚ö°</span> Execute Block Response
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.5/socket.io.min.js"></script>
    <script src="/static/app.js"></script>
</body>

</html>